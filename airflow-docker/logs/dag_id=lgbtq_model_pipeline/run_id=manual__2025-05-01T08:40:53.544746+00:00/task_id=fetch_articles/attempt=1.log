[2025-05-01T08:40:56.120+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: lgbtq_model_pipeline.fetch_articles manual__2025-05-01T08:40:53.544746+00:00 [queued]>
[2025-05-01T08:40:56.124+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: lgbtq_model_pipeline.fetch_articles manual__2025-05-01T08:40:53.544746+00:00 [queued]>
[2025-05-01T08:40:56.124+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 1
[2025-05-01T08:40:56.129+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): fetch_articles> on 2025-05-01 08:40:53.544746+00:00
[2025-05-01T08:40:56.134+0000] {standard_task_runner.py:57} INFO - Started process 189 to run task
[2025-05-01T08:40:56.136+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'lgbtq_model_pipeline', 'fetch_articles', 'manual__2025-05-01T08:40:53.544746+00:00', '--job-id', '142', '--raw', '--subdir', 'DAGS_FOLDER/lgbtq_model_pipeline.py', '--cfg-path', '/tmp/tmpow5mwxa0']
[2025-05-01T08:40:56.141+0000] {standard_task_runner.py:85} INFO - Job 142: Subtask fetch_articles
[2025-05-01T08:40:56.167+0000] {task_command.py:416} INFO - Running <TaskInstance: lgbtq_model_pipeline.fetch_articles manual__2025-05-01T08:40:53.544746+00:00 [running]> on host fb9d9c799b14
[2025-05-01T08:40:56.203+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='lgbtq_model_pipeline' AIRFLOW_CTX_TASK_ID='fetch_articles' AIRFLOW_CTX_EXECUTION_DATE='2025-05-01T08:40:53.544746+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-01T08:40:53.544746+00:00'
[2025-05-01T08:40:56.204+0000] {logging_mixin.py:154} INFO - Fetching CSV data from Google Sheets...
[2025-05-01T08:40:57.125+0000] {logging_mixin.py:154} INFO - ðŸ“Š Columns from Google Sheet: ['date', 'title', 'url', 'publication', 'author', 'stance', 'topic_category', 'content']
[2025-05-01T08:40:57.129+0000] {logging_mixin.py:154} INFO - Generating embeddings...
[2025-05-01T08:40:57.131+0000] {SentenceTransformer.py:208} INFO - Use pytorch device_name: cpu
[2025-05-01T08:40:57.131+0000] {SentenceTransformer.py:216} INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
[2025-05-01T08:40:58.761+0000] {file_download.py:1670} WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
[2025-05-01T08:41:11.282+0000] {logging_mixin.py:154} INFO - Loading classifier...
[2025-05-01T08:41:11.304+0000] {logging_mixin.py:154} WARNING - /home/***/.local/lib/python3.8/site-packages/sklearn/base.py:348 InconsistentVersionWarning: Trying to unpickle estimator LogisticRegression from version 1.5.1 when using version 1.3.2. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
[2025-05-01T08:41:11.305+0000] {logging_mixin.py:154} INFO - Predicting stances...
[2025-05-01T08:41:11.308+0000] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/tasks/fetch_articles.py", line 54, in run
    json.dump(output, f, indent=2)
  File "/usr/local/lib/python3.8/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/usr/local/lib/python3.8/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/local/lib/python3.8/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/usr/local/lib/python3.8/json/encoder.py", line 438, in _iterencode
    o = _default(o)
  File "/usr/local/lib/python3.8/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type int64 is not JSON serializable
[2025-05-01T08:41:11.317+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=lgbtq_model_pipeline, task_id=fetch_articles, execution_date=20250501T084053, start_date=20250501T084056, end_date=20250501T084111
[2025-05-01T08:41:11.327+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 142 for task fetch_articles (Object of type int64 is not JSON serializable; 189)
[2025-05-01T08:41:11.343+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2025-05-01T08:41:11.358+0000] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
